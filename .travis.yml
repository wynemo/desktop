language: node_js
os: windows

node_js:
  - "node"

python:
  - "2.7"

before_script:
  - npm install -g electron-packager
  - npm install -g asar

script:
  - curl https://files.pythonhosted.org/packages/37/db/89d6b043b22052109da35416abc3c397655e4bd3cff031446ba02b9654fa/virtualenv-16.4.3.tar.gz > virtualenv-16.4.3.tar.gz
  - 7z e virtualenv-16.4.3.tar.gz && 7z x virtualenv-16.4.3.tar
  - python virtualenv-16.4.3/virtualenv.py env
  - env/bin/pip install pyinstaller xlwt
  - env/bin/pyinstaller --onefile pycalc/check.py
  - electron-packager . --overwrite --asar --ignore=.git --ignore=build
  - cp -r dist managment_software-win32-x64/
  - cp pycalc/info.dat managment_software-win32-x64/dist/
  - 7z a -tzip managment_software.zip -r managment_software-win32-x64

deploy:
  provider: releases
  api_key: 'ccc63df3cd195a3dbd199e73bd8a2762326e3b35'
  file: 'managment_software.zip'
  skip_cleanup: true
